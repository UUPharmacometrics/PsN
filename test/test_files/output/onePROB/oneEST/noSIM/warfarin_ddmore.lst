28/01/2015 
11:01
; Script generated by the pharmML2Nmtran Converter v.1.0.0
; Source	: PharmML 0.3.1
; Target	: NMTRAN 7.2.0
; Model 	: Warfarin-ODE-latest
; Dated 	: Wed Jan 28 11:01:24 GMT 2015
$PROBLEM    "Warfarin-ODE-latest - generated by MDL2PharmML v.6.0"
$INPUT      ID TIME WT AMT DVID DV MDV LOGTWT
$DATA      warfarin_conc.csv IGNORE=@
$SUBROUTINE ADVAN13 TOL=9
$MODEL      COMP (GUT) COMP (CENTRAL)
$PK 
POP_CL = THETA(1)
POP_V = THETA(2)
POP_KA = THETA(3)
POP_TLAG = THETA(4)
RUV_PROP = THETA(5)
RUV_ADD = THETA(6)
BETA_CL_WT = THETA(7)
BETA_V_WT = THETA(8)

ETA_CL = ETA(1)
ETA_V = ETA(2)
ETA_KA = ETA(3)
ETA_TLAG = ETA(4)

MU_1 = LOG(POP_CL)+BETA_CL_WT * logtWT;
CL = EXP(MU_1 + ETA(1));

MU_2 = LOG(POP_V)+BETA_V_WT * logtWT;
V = EXP(MU_2 + ETA(2));

MU_3 = LOG(POP_KA);
KA = EXP(MU_3 + ETA(3));

MU_4 = LOG(POP_TLAG);
TLAG = EXP(MU_4 + ETA(4));

$DES 
GUT = A(1)
CENTRAL = A(2)

RATEIN =   0.0;
IF (T.GE.TLAG) THEN
	RATEIN =  (GUT * KA) 
ELSE
	RATEIN =  0 
ENDIF

CC_DES =  (CENTRAL / V)
DADT(1) = -(RATEIN)
DADT(2) = (RATEIN - ((CL * CENTRAL) / V))

$ERROR 
CC =  (A(2) / V)

IPRED = CC
W = RUV_ADD+RUV_PROP*IPRED
Y = IPRED+W*EPS(1)
IRES = DV - IPRED
IWRES = IRES/ W

$THETA  (0.0010,0.1) ; POP_CL
 (0.0010,8.0) ; POP_V
 (0.0010,0.362) ; POP_KA
 (0.0010,1.0) ; POP_TLAG
 0.1 ; RUV_PROP
 0.1 ; RUV_ADD
 0.75 FIX ; BETA_CL_WT
 1.0 FIX ; BETA_V_WT
$OMEGA  BLOCK(2) STANDARD CORRELATION
 0.1  ;     PPV_CL
 0.01  ; CORR_PPV_CL_V
 0.1  ;      PPV_V
$OMEGA  0.1  STANDARD  ;     PPV_KA
 0.1  STANDARD  ;   PPV_TLAG
$SIGMA  1.0  FIX
$ESTIMATION METHOD=SAEM INTER CTYPE=3 NITER=1000 NBURN=4000 NOPRIOR=1
            CITER=10 CALPHA=0.05 IACCEPT=0.4 ISCALE_MIN=1.0E-06
            ISCALE_MAX=1.0E+06 ISAMPLE_M1=2 ISAMPLE_M1A=0 ISAMPLE_M2=2
            ISAMPLE_M3=2 CONSTRAIN=1 EONLY=0 ISAMPLE=2 PRINT=50
$TABLE      ID TIME WT AMT DVID MDV LOGTWT PRED IPRED RES IRES WRES
            IWRES Y DV NOAPPEND NOPRINT FILE=sdtab
$TABLE      ID CL V KA TLAG ETA_CL ETA_V ETA_KA ETA_TLAG NOAPPEND
            NOPRINT FILE=patab
$TABLE      ID LOGTWT NOAPPEND NOPRINT FILE=cotab

  
NM-TRAN MESSAGES 
  
 WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1
             
 (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.

 (MU_WARNING 26) DATA ITEM(S) USED IN DEFINITION OF MU_(S) SHOULD BE CONSTANT FOR INDIV. REC.:
  LOGTWT
 CREATING MUMODEL ROUTINE...
  
License Registered to: Mango Business Solutions Ltd
Expiration Date:    14 OCT 2015
Current Date:       28 JAN 2015
Days until program expires : 256
1NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) VERSION 7.2.0
 ORIGINALLY DEVELOPED BY STUART BEAL, LEWIS SHEINER, AND ALISON BOECKMANN
 CURRENT DEVELOPERS ARE ROBERT BAUER, ICON DEVELOPMENT SOLUTIONS,
 AND ALISON BOECKMANN. IMPLEMENTATION, EFFICIENCY, AND STANDARDIZATION
 PERFORMED BY NOUS INFOSYSTEMS.
 
 PROBLEM NO.:         1
 "Warfarin-ODE-latest - generated by MDL2PharmML v.6.0"                  
0DATA CHECKOUT RUN:              NO 
 DATA SET LOCATED ON UNIT NO.:    2
 THIS UNIT TO BE REWOUND:        NO 
 NO. OF DATA RECS IN DATA SET:      288
 NO. OF DATA ITEMS IN DATA SET:   9
 ID DATA ITEM IS DATA ITEM NO.:   1
 DEP VARIABLE IS DATA ITEM NO.:   6
 MDV DATA ITEM IS DATA ITEM NO.:  7
0INDICES PASSED TO SUBROUTINE PRED:
   9   2   4   0   0   0   0   0   0   0   0
0LABELS FOR DATA ITEMS:
 ID TIME WT AMT DVID DV MDV LOGTWT EVID
0(NONBLANK) LABELS FOR PRED-DEFINED ITEMS:
 ETA_CL ETA_V ETA_KA ETA_TLAG CL V KA TLAG IPRED Y IRES IWRES
0FORMAT FOR DATA:
 (E3.0,E4.0,2E5.0,E2.0,E5.0,E2.0,E13.0,1F2.0)                                    
 
 TOT. NO. OF OBS RECS:      250
 TOT. NO. OF INDIVIDUALS:     32
0LENGTH OF THETA:   8
0DEFAULT THETA BOUNDARY TEST OMITTED:    NO 
0OMEGA HAS BLOCK FORM:
  1
  1  1
  0  0  2
  0  0  0  3
0DEFAULT OMEGA BOUNDARY TEST OMITTED:    NO 
0SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:   1
0DEFAULT SIGMA BOUNDARY TEST OMITTED:    NO 
0INITIAL ESTIMATE OF THETA:
 LOWER BOUND    INITIAL EST    UPPER BOUND
  0.1000E-02     0.1000E+00     0.1000E+07
  0.1000E-02     0.8000E+01     0.1000E+07
  0.1000E-02     0.3620E+00     0.1000E+07
  0.1000E-02     0.1000E+01     0.1000E+07
 -0.1000E+07     0.1000E+00     0.1000E+07
 -0.1000E+07     0.1000E+00     0.1000E+07
  0.7500E+00     0.7500E+00     0.7500E+00
  0.1000E+01     0.1000E+01     0.1000E+01
0INITIAL ESTIMATE OF OMEGA:
 BLOCK SET NO.   BLOCK                                                                    FIXED
        1                                                                                   NO 
                  0.1000E-01
                  0.1000E-03   0.1000E-01
        2                                                                                   NO 
                  0.1000E-01
        3                                                                                   NO 
                  0.1000E-01
0INITIAL ESTIMATE OF SIGMA:
 0.1000E+01
0SIGMA CONSTRAINED TO BE THIS INITIAL ESTIMATE
0ESTIMATION STEP OMITTED:           NO 
 CONDITIONAL ESTIMATES USED:       YES 
 CENTERED ETA:                      NO 
 EPS-ETA INTERACTION:              YES 
 LAPLACIAN OBJ. FUNC.:              NO 
 NO. OF FUNCT. EVALS. ALLOWED:        960
 NO. OF SIG. FIGURES REQUIRED:       3
 INTERMEDIATE PRINTOUT:            YES 
 ESTIMATE OUTPUT TO MSF:            NO 
 IND. OBJ. FUNC. VALUES SORTED:     NO 
0TABLES STEP OMITTED:    NO 
 NO. OF TABLES:           3
0-- TABLE   1 --
04 COLUMNS APPENDED:     NO 
 PRINTED:                NO 
 HEADER:                YES 
 FILE TO BE FORWARDED:   NO 
0USER-CHOSEN ITEMS:
 ID TIME WT AMT DVID MDV LOGTWT PRED IPRED RES IRES WRES IWRES Y DV
0-- TABLE   2 --
04 COLUMNS APPENDED:     NO 
 PRINTED:                NO 
 HEADER:                YES 
 FILE TO BE FORWARDED:   NO 
0USER-CHOSEN ITEMS:
 ID CL V KA TLAG ETA_CL ETA_V ETA_KA ETA_TLAG
0-- TABLE   3 --
04 COLUMNS APPENDED:     NO 
 PRINTED:                NO 
 HEADER:                YES 
 FILE TO BE FORWARDED:   NO 
0USER-CHOSEN ITEMS:
 ID LOGTWT

 THE FOLLOWING LABELS ARE EQUIVALENT
 PRED=PREDI
 RES=RESI
 WRES=WRESI
1DOUBLE PRECISION PREDPP VERSION 7.2.0     
 
 GENERAL NONLINEAR KINETICS MODEL USING LSODA (ADVAN13)
0MODEL SUBROUTINE USER-SUPPLIED - ID NO. 9999
0MAXIMUM NO. OF BASIC PK PARAMETERS:   4
0COMPARTMENT ATTRIBUTES 
 COMPT. NO.   FUNCTION   INITIAL    ON/OFF      DOSE      DEFAULT    DEFAULT
                         STATUS     ALLOWED    ALLOWED    FOR DOSE   FOR OBS.
    1         GUT          ON         YES        YES        YES        NO 
    2         CENTRAL      ON         YES        YES        NO         YES
    3         OUTPUT       OFF        YES        NO         NO         NO 
0NRD VALUE(S) FROM SUBROUTINE TOL:   9
1
 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG
 COMPT. NO.                             INDICES
              SCALE      BIOAVAIL.   ZERO-ORDER  ZERO-ORDER  ABSORB
                         FRACTION    RATE        DURATION    LAG  
    1           *           *           *           *           *
    2           *           *           *           *           *
    3           *           -           -           -           -
             - PARAMETER IS NOT ALLOWED FOR THIS MODEL
             * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;
               WILL DEFAULT TO ONE IF APPLICABLE
0DATA ITEM INDICES USED BY PRED ARE:
   EVENT ID DATA ITEM IS DATA ITEM NO.:      9
   TIME DATA ITEM IS DATA ITEM NO.:          2
   DOSE AMOUNT DATA ITEM IS DATA ITEM NO.:   4
 
0PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.
 PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES.
0ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.
0ERROR SUBROUTINE INDICATES THAT DERIVATIVES OF COMPARTMENT AMOUNTS ARE USED.
0DES SUBROUTINE USES FULL STORAGE MODE.
1


 #TBLN:      1
 #METH: Stochastic Approximation Expectation-Maximization (No Prior)

 EM/BAYES SETUP
 THETAS THAT ARE MU MODELED:
   1   2   3   4
 THETAS THAT ARE SIGMA-LIKE:
 

 MONITORING OF SEARCH:

 Stochastic/Burn-in Mode
 iteration        -4000  SAEMOBJ=   2172.4323897462391
 iteration        -3950  SAEMOBJ=  -404.68869916559305
 iteration        -3900  SAEMOBJ=  -381.24012294836257
 iteration        -3850  SAEMOBJ=  -408.35532202828887
 iteration        -3800  SAEMOBJ=  -411.10542856362338
 iteration        -3750  SAEMOBJ=  -408.58593773923474
 iteration        -3700  SAEMOBJ=  -419.80365987261547
 iteration        -3650  SAEMOBJ=  -406.44620642323332
 iteration        -3600  SAEMOBJ=  -419.58204488245030
 iteration        -3550  SAEMOBJ=  -419.71219522477389
 iteration        -3500  SAEMOBJ=  -416.34870128578382
 iteration        -3450  SAEMOBJ=  -434.37140636094477
 iteration        -3400  SAEMOBJ=  -406.28794328942274
 Convergence achieved
 Reduced Stochastic/Accumulation Mode
 iteration            0  SAEMOBJ=  -399.23544975750787
 iteration           50  SAEMOBJ=  -439.22614080807659
 iteration          100  SAEMOBJ=  -434.09084161993201
 iteration          150  SAEMOBJ=  -431.31083443098748
 iteration          200  SAEMOBJ=  -430.55058206291352
 iteration          250  SAEMOBJ=  -429.47386211285959
 iteration          300  SAEMOBJ=  -428.86404964967005
 iteration          350  SAEMOBJ=  -429.03004187454553
 iteration          400  SAEMOBJ=  -428.95879035699664
 iteration          450  SAEMOBJ=  -429.16895692791218
 iteration          500  SAEMOBJ=  -429.70910715742849
 iteration          550  SAEMOBJ=  -430.50951830827086
 iteration          600  SAEMOBJ=  -431.21037141853787
 iteration          650  SAEMOBJ=  -432.19100825789468
 iteration          700  SAEMOBJ=  -433.43260046207865
 iteration          750  SAEMOBJ=  -434.75491507647899
 iteration          800  SAEMOBJ=  -436.27272653649567
 iteration          850  SAEMOBJ=  -438.36758413149960
 iteration          900  SAEMOBJ=  -440.53067679313244
 iteration          950  SAEMOBJ=  -444.31494407510343
 iteration         1000  SAEMOBJ=  -462.89197874404806

 #TERM:
 STOCHASTIC PORTION COMPLETED
 REDUCED STOCHASTIC PORTION COMPLETED

 ETABAR IS THE ARITHMETIC MEAN OF THE ETA-ESTIMATES,
 AND THE P-VALUE IS GIVEN FOR THE NULL HYPOTHESIS THAT THE TRUE MEAN IS 0.

 ETABAR:         1.1116E-05  3.3897E-06  3.3673E-06 -3.1544E-06
 SE:             4.5076E-02  2.0706E-02  8.7831E-02  2.5609E-02

 P VAL.:         9.9980E-01  9.9987E-01  9.9997E-01  9.9990E-01

 ETAshrink(%):   1.3927E+00  1.3092E+01  4.9181E+01  5.3072E+01
 EPSshrink(%):   7.6245E+00

 #TERE:
 Elapsed estimation time in seconds:   466.87
1
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************           STOCHASTIC APPROXIMATION EXPECTATION-MAXIMIZATION (NO PRIOR)         ********************
 #OBJT:**************                        FINAL VALUE OF LIKELIHOOD FUNCTION                      ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 





 #OBJV:********************************************     -462.892       **************************************************
1
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************           STOCHASTIC APPROXIMATION EXPECTATION-MAXIMIZATION (NO PRIOR)         ********************
 ********************                             FINAL PARAMETER ESTIMATE                           ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 


 THETA - VECTOR OF FIXED EFFECTS PARAMETERS   *********


         TH 1      TH 2      TH 3      TH 4      TH 5      TH 6      TH 7      TH 8     
 
         1.33E-01  8.15E+00  1.79E+00  8.75E-01  1.06E-01 -1.35E-15  7.50E-01  1.00E+00
 


 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS  ********


            ETA1      ETA2      ETA3      ETA4   
 
 ETA1
+        6.90E-02
 
 ETA2
+        8.44E-03  1.88E-02
 
 ETA3
+        0.00E+00  0.00E+00  9.87E-01
 
 ETA4
+        0.00E+00  0.00E+00  0.00E+00  9.84E-02
 


 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS  ****


            EPS1   
 
 EPS1
+        1.00E+00
 
1


 OMEGA - CORR MATRIX FOR RANDOM EFFECTS - ETAS  *******


            ETA1      ETA2      ETA3      ETA4   
 
 ETA1
+        2.63E-01
 
 ETA2
+        2.35E-01  1.37E-01
 
 ETA3
+        0.00E+00  0.00E+00  9.93E-01
 
 ETA4
+        0.00E+00  0.00E+00  0.00E+00  3.14E-01
 


 SIGMA - CORR MATRIX FOR RANDOM EFFECTS - EPSILONS  ***


            EPS1   
 
 EPS1
+        1.00E+00
 
Stop Time: 
28/01/2015 
11:09
