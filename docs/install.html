<!DOCTYPE html PUBLIC -//W3C//DTD XHTML 1.0 Strict//EN   http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd>
<html>
<head>
    <title>PsN :: Install</title>
	<style type="text/css">

a { text-decoration: none; }
a:hover { text-decoration: underline; text-decoration-style: dashed; }

</style>
    <link rel="stylesheet" type="text/css" href="style/style.css">
    <script type="text/javascript" src="javascript/jquery.js"></script>
    <script>
        // @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt
        $(function() {
            $("#nav").load("menu.html");
            $("#footer").load("footer.html");
        });
        // @license-end
    </script>

</head>
<body>
    <div id="wrap">
        <div id="header"></div>
        <div id="nav"></div>
        <div id="main">


<h2>Installation</h2>


<h3>Required Software</h3>

<h4>NONMEM</h4>
PsN supports standard installations of <a target="_blank" href="https://nonmem.iconplc.com/">NONMEM</a>. <br>
Verify that all NONMEM installations you intend to use can be run directly via the nmfe script and that they produce complete output files.<br>
If running NONMEM with nmfe does not work then PsN will not work either.<br>
If you plan to use the parallelization features of NONMEM you must also
verify that you can run NONMEM in parallel directly with the nmfe script.<br>
</li>

<hr COLOR="darkred">




<h3>Windows</h3>

PsN comes bundled with all its dependencies to make it easier to install. Included is PsN itself, perl, R, python, perl packages, R packages, python packages and Pharmpy. Everything is tested together and nothing should interfere with any other installations of the same software that you might have on your computer.

<ol>
<li>Unpack the file you downloaded from the <a target="_blank" href="https://uupharmacometrics.github.io/PsN/download.html">PsN Download Page</a>. The unpacked directory can be put at any location on your computer.</li>
<li>Update your PATH environment variable to include the path to PsN-5.3.1\strawberry\perl\bin</li>
<li>Add your NONMEM version by editing the PsN configuration file at PsN-5.3.1\strawberry\perl\site\lib\PsN_5_3_1\psn.conf. Under [nm_versions] add for example default=C:\nm751,7.5.1 if your NONMEM version is 7.5.1 and can be found under C:\nm751</li>
</ol>


<hr COLOR="darkred">


<h3>Linux</h3>

Before installing PsN on Linux, you should make sure that the required programs are installed on your computer.

<ul>
    <li>Perl version 5.10.1 or later</li>
    <li>Python 3.8 or later</li>
    <li>make</li>
</ul>

<h5>Ubuntu/Debian</h5>
<code>
apt install python3 python3-venv python3-dev<br>
apt install make<br>
</code>

<h4>Installing system dependencies for plotting and reporting</h4>

To be able to use the automatic rplotting functionality (via the <code>-rplots</code> option)  and/or the <code>qa</code> tool the following needs to be installed:
<ul>
    <li><a target="_blank" href="https://cloud.r-project.org"s>R</a> version 4.0 or later</li>
    <li>pandoc</li>
    <li>System dependencies for R packages</li>
</ul>

<h5>Ubuntu/Debian</h5>
<code>
apt install r-base<br>
apt install pandoc<br>
apt install libpq-dev<br>
apt install libcairo2-dev<br>
apt install libssl-dev<br>
apt install libcurl4-openssl-dev<br>
apt install libmariadb-dev<br>
apt install libgmp-dev<br>
apt install libmpfr-dev<br>
apt install libxml2-dev<br>
apt install libudunits2-dev<br>
apt install libblas-dev<br>
apt install liblapack-dev<br>
apt install libmagick++-dev<br>
</code>

<h5>CentOS/Fedora</h5>
<code>
yum install R<br>
yum install pandoc<br>
yum install openssl-devel<br>
yum install libcurl-devel<br>
yum install cairo-devel<br>
yum install mariadb-devel<br>
yum install libxml2-devel<br>
yum install ImageMagick-c++-devel<br>
</code>
<br>



<h4>Installing Perl modules</h4>
You might need to answer some questions interactively when using the cpan command.
<ol>
<li>Open a terminal.</li><p>
<li>Run the following commands (hit &#8629; after each command), prepend sudo if necessary:<br>
<code>cpan Math::Random<br>
cpan Math::MatrixReal<br>
cpan Mouse<br>
cpan MouseX::Params::Validate<br>
cpan Archive::Zip<br>
cpan YAML<br>
cpan Capture::Tiny<br>
cpan File::Copy::Recursive<br>
cpan Config::Tiny<br>
cpan File::HomeDir<br>
cpan Math::SigFigs<br>
cpan Statistics::Distributions<br>
</code>
</li>
</ol>

<h4>Installing PsN</h4>
<ol type="A">
<li>
<p>Unpack the file you downloaded from the <a target="_blank" href="https://uupharmacometrics.github.io/PsN/download.html">PsN Download Page</a>.
It will create a directory called <code>PsN-Source.</code></p>
</li>
<li>
<div style="text-align: justify;">
Open a terminal, cd to the <code>PsN-Source</code> directory and type: <code>sudo perl setup.pl</code> and &#8629;.</p>
<p>sudo can be skipped if you already have write permissions in the installation directories you intend to use. <br>
</li>
<li>
Read all messages carefully and answer the questions on screen.

The default settings are probably the best for most users. It is <b>highly</b> recommended to let the installation script create <code>psn.conf.</code> automatically unless you are experienced in installing and configuring PsN.<br>
</li>
</ol>



<hr COLOR="darkred">




<h3>macOS</h3>

<h4>Required software on macOS</h4>

Before you install PsN on Linux or MacOS, you should make sure that the required programs and modules are installed on your computer.
<ul>
    <li>Perl version 5.10.1 or later</li>
    <li>Python 3.8 or later</li>
</ul>
To be able to use the automatic rplotting functionality (via the <code>-rplots</code> option)  and/or the <code>qa</code> tool the following needs to be installed:
<ul>
    <li><a target="_blank" href="https://cloud.r-project.org"s>R</a> version 4.0 or later</li>
    <li>pandoc</li>
</ul>

<h4>Installing system dependencies for plotting and reporting</h4>
The dependencies of PsNR need some system packages to be installed. One option is to install them via via brew:<br>
<code>openssl@1.1<br>
cairo<br></code>
<code>and<br>
mariadb-connector-c.</code>
<br><br>

<h4>Installing Perl modules</h4>
You might need to answer some questions interactively when using the cpan command.
<ol>
<li>Open a terminal.</li><p>
<li>Run the following commands (hit &#8629; after each command), prepend sudo if necessary:<br>
<code>cpan Math::Random<br>
cpan Math::MatrixReal<br>
cpan Mouse<br>
cpan MouseX::Params::Validate<br>
cpan Archive::Zip<br>
cpan YAML<br>
cpan Capture::Tiny<br>
cpan File::Copy::Recursive<br>
cpan Config::Tiny<br>
cpan File::HomeDir<br>
cpan Math::SigFigs<br>
cpan Statistics::Distributions<br>
</code>
</li>
</ol>
In some cases it might be necessary to install a newer version of Perl via brew:
<ol>
    <li>Install <a href="https://brew.sh">homebrew</a></li>
    <li>Install Perl via homebrew: <code>brew install perl</code></li>
    <li>Tell the system which perl to use (the following could be put into your <code>~/.bash_profile</code>:
        <ol>
            <li><code>alias perl=/usr/local/Cellar/perl/5.30.0/bin/perl</code></li>
            <li><code>alias cpan=/usr/local/Cellar/perl/5.30.0/bin/cpan</code></li>
        </ol>
    </li>
    <li>Now install the Perl packages</li>
    <li>When installing PsN remember to set the path to the brew version of Perl as the perl binary to use. (use <code>which perl</code>)</li>
</ol>

<h4>Installing PsN</h4>
<ol type="A">
<li>
<p>Unpack the file you downloaded from the <a target="_blank" href="https://uupharmacometrics.github.io/PsN/download.html">PsN Download Page</a>.
It will create a directory called <code>PsN-Source.</code></p>
</li>
<li>
<div style="text-align: justify;">
Open a terminal, cd to the <code>PsN-Source</code> directory and type: <code>sudo perl setup.pl</code> and &#8629;.</p>
<p>sudo can be skipped if you already have write permissions in the installation directories you intend to use. <br><br>
</li>
<li>
Read all messages carefully and answer the questions on screen.
</ol>

Mac users with the latest version(s) of Mac Os <b>cannot</b> accept the default installation folder for PsN utilities, even when installing as root.<sup>1</sup>
<br>Do the following:<br>
Run <code>setup.pl</code> as root.<p>
When setup.pl prompts for the PsN Utilities directory like this:<br>
<code>PsN Utilities installation directory [/usr/bin]:</code><br>
type <code>/usr/local/bin</code> and &#8629;.<br><p>
The other default settings can be accepted.<br>
If there is a message about PsN already being installed this message is misleading,
what it should say is that PsN is already *partially* installed. This is not an error,
just say yes to continue.</p>




<hr COLOR="darkred">

<h2>Configuring PsN</h2>
<li> If you did not let the installation script create the configuration file <code>psn.conf</code> for you, or if you are running NONMEM via NMQual or
on a cluster, you need to edit <code>psn.conf</code> in the PsN installation directory. <br>
The document <a target="_blank" href="https://github.com/UUPharmacometrics/PsN/releases/download/5.3.1/psn_configuration.pdf">PsN Configuration.pdf</a> describes how to make the correct settings in the psn.conf file.
</li><br>


<hr COLOR="darkred">

<h2>Portable PsN installations</h2>
This functionality is intended for advanced users only. The setup.pl script takes an optional argument 'relative': <br>
<code>setup.pl relative </code><br>
If this argument is given, the bin scripts (PsN Utilities) will use a relative path when including the lib modules (PsN Core and Toolkit).
This makes the PsN installation directory movable, as long as the relative position between the bin scripts and lib modules remains the same.<br>
In addition the <code>[nm_versions]</code> section in psn.conf can list the name of the nmfe executables instead of the full path to the NONMEM installation directories
<b>if at runtime</b> the nmfe executable, chosen by default or with option -nm_version, is in the user $PATH, see documentation in
<a target="_blank" href="https://github.com/UUPharmacometrics/PsN/releases/download/5.3.1/psn_configuration.pdf">PsN Configuration.pdf</a>.
<br>The test package, if installed, will not be portable even if setup.pl is run with argument relative. If the test package is moved, the file
<code>test/includes.pm</code> must be edited manually before any tests are run.


<hr COLOR="darkred">

<h2>Multiple PsN installations</h2>

<h3>On Windows</h3>
Since each version of PsN comes in its own bundle, multiple versions can be installed at the same time, but only one can be active in PATH at a time.

<h3>On Linux and macOS</h3>
It is possible to have several installations of PsN and use them in parallel. The default version of PsN may be changed every time a new installation is made.
To check which PsN version is the default use the command<br>
<code>psn -version</code><br>
A specific version may be called with its version number, for example<br>
<code>execute-5.3.1  -help</code><br>

</div>
<div id="footer" style="padding-top:2px;padding-right:2px;padding-left:2px;"></div>
</div>
</body>
</html>
